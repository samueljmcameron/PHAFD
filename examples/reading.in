# set global parameters


domain boxdims 100.0 100.0 100.0 boxorigin -50.0 -50.0 -50.0

grid_style 64 64 64 concentration

grid_populate constant concentration 0.2 0.2 349810 
# or
#grid_populate read concentration vtkfiles/read_nucd_p%_100000.vti


read_atoms simple_p%.data 

# can either use grid_setup to read in old data or create new grid data	

pair gridatom/gaussian 4.0
pairCoeffs 0 phi 0.9 epsilon 4.0
pairCoeffs 1 phi 0.1 epsilon 4.0

pair lj/cut 2.0 1.0 1.781794

neighbor 2.0

group nt_pmers molecule 0 1

fix atom/semiflexible/notether nt_pmers nt_pmers 58912094 bondlength 2.0 zeta_para 0.5 zeta_perp 1.0 bending 206.0 temp 4.114 

fix grid/conjugate/volfrac volfrac 491240 mobility 0.01 temp 1.0 volFH 0.01 gamma 10.0 

fix grid/floryhuggins chempot temp 1.0 chi 3.0 volFH 0.01


compute complex norm ft_phi norm

compute pair droppolyforces gridatom/gaussian

fix grid/ave averagenorm 100 10 1000 c_norm

dump atoms atom/owned vtkfiles/atom_p% 1000 attributes 5 x ux ix F c_droppolyforces

dump realgrid grid vtkfiles/field_p% 1000 attributes 2 phi nonlinear 
dump fouriergrid ftgrid vtkfiles/ft_field_p% 1000 attributes 1 f_averagenorm



timestep 0
dt 1e-3

run 10000

